{% schema %}
{
  "name": "Testimonials Slider",
  "settings": [],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "textarea",
          "id": "quote",
          "label": "Quote"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Customer Name"
        },
        {
          "type": "text",
          "id": "role",
          "label": "Role / Location"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonials Slider"
    }
  ]
}
{% endschema %}

<section id="testimonial-section">
  <div class="testimonial-wrapper">
    <button class="arrow left">‹</button>

    <div class="testimonial-track">
      {% for block in section.blocks %}
      <div class="testimonial-card">
        <div class="image-box">
          {% if block.settings.image %}
            <img src="{{ block.settings.image | img_url: 'medium' }}" alt="">
          {% endif %}
        </div>

        <div class="text-box">
          <p class="quote">{{ block.settings.quote }}</p>
          <p class="name">{{ block.settings.name }}</p>
          <p class="role">{{ block.settings.role }}</p>
        </div>
      </div>
      {% endfor %}
    </div>

    <button class="arrow right">›</button>
  </div>
</section>

<style>
#testimonial-section {
  padding: 70px 0;
}

.testimonial-wrapper {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
}

.testimonial-track {
  display: flex;
  gap: 35px; /* Perfect card spacing */
  overflow: hidden;
  scroll-behavior: smooth;
  padding: 20px 0;
  width: 82%; /* Center width alignment */
}

.testimonial-card {
  background: white;
  width: 310px;
  border-radius: 26px; /* Smooth rounded corners */
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  transition: transform 0.4s ease, box-shadow 0.4s ease;
}

.testimonial-card.active {
  transform: scale(1.16); /* Medium lift */
  box-shadow: 0 18px 45px rgba(0,0,0,0.14);
}

.image-box {
  height: 200px; /* 60% of card height */
  overflow: hidden;
}

.image-box img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.text-box {
  padding: 25px 20px;
  text-align: center;
}

.quote {
  font-size: 15px;
  line-height: 1.5;
  margin-bottom: 18px;
}

.name {
  font-weight: bold;
  font-size: 14px;
}

.role {
  font-size: 12px;
  opacity: 0.6;
}

/* Arrows */
.arrow {
  position: absolute;
  background: white;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  border: none;
  box-shadow: 0 4px 15px rgba(0,0,0,0.12);
  cursor: pointer;
  font-size: 22px;
  display: flex;
  justify-content: center;
  align-items: center;
  top: 50%;
  transform: translateY(-50%);
  z-index: 10;
}

.arrow.left { left: 40px; }
.arrow.right { right: 40px; }

.arrow:hover {
  transform: translateY(-50%) scale(1.1);
}
</style>

<script>
const track = document.querySelector('.testimonial-track');
const cards = document.querySelectorAll('.testimonial-card');
const left = document.querySelector('.arrow.left');
const right = document.querySelector('.arrow.right');

let index = 1;

function activateCard() {
  cards.forEach(c => c.classList.remove('active'));
  cards[index]?.classList.add('active');
  track.scrollTo({
    left: cards[index].offsetLeft - track.offsetWidth / 2 + cards[index].offsetWidth / 2,
    behavior: "smooth"
  });
}

activateCard();

right.onclick = () => {
  index = (index + 1) % cards.length;
  activateCard();
};

left.onclick = () => {
  index = (index - 1 + cards.length) % cards.length;
  activateCard();
};
</script>
